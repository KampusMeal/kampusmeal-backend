{
  "info": {
    "_postman_id": "kampus-meal-collection",
    "name": "Kampus Meal API",
    "description": "API Collection untuk Kampus Meal Backend\n\n## 3 Role System:\n- **User** (Pembeli) - Browse & search stalls\n- **Admin** (Tim Dev) - Register stall owners\n- **Stall Owner** (Pemilik Warung) - Manage their stall\n\n## Testing Flow:\n1. Register Admin → Login Admin\n2. Admin Register Stall Owner (creates user + stall)\n3. Stall Owner Login → Manage stall (seamless, no ID!)\n4. User Register → Login → Browse stalls",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "User Endpoints",
      "description": "Endpoints untuk User Biasa (Pembeli)",
      "item": [
        {
          "name": "Auth",
          "item": [
            {
              "name": "Register User",
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"username\": \"{{user_username}}\",\n  \"email\": \"{{user_email}}\",\n  \"password\": \"{{user_password}}\",\n  \"confirmPassword\": \"{{user_password}}\"\n}"
                },
                "url": {
                  "raw": "{{base_url}}/auth/register",
                  "host": ["{{base_url}}"],
                  "path": ["auth", "register"]
                },
                "description": "Register user baru dengan role 'user' (pembeli)."
              },
              "response": []
            },
            {
              "name": "Login User",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "var jsonData = pm.response.json();",
                      "if (jsonData.success && jsonData.data && jsonData.data.token) {",
                      "    pm.environment.set(\"user_token\", jsonData.data.token);",
                      "    console.log(\"User token saved\");",
                      "}"
                    ],
                    "type": "text/javascript"
                  }
                }
              ],
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"identifier\": \"{{user_email}}\",\n  \"password\": \"{{user_password}}\"\n}"
                },
                "url": {
                  "raw": "{{base_url}}/auth/login",
                  "host": ["{{base_url}}"],
                  "path": ["auth", "login"]
                },
                "description": "Login sebagai user. Token auto-saved ke `{{user_token}}`"
              },
              "response": []
            },
            {
              "name": "Logout User",
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{user_token}}",
                    "type": "text"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/auth/logout",
                  "host": ["{{base_url}}"],
                  "path": ["auth", "logout"]
                }
              },
              "response": []
            }
          ]
        },
        {
          "name": "Browse Stalls",
          "item": [
            {
              "name": "Get All Stalls",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{user_token}}",
                    "type": "text"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/stalls?page=1&limit=10&sortBy=rating&sortOrder=desc",
                  "host": ["{{base_url}}"],
                  "path": ["stalls"],
                  "query": [
                    {
                      "key": "search",
                      "value": "{{search_keyword}}",
                      "disabled": true
                    },
                    {
                      "key": "category",
                      "value": "Indonesian Food",
                      "disabled": true
                    },
                    {
                      "key": "minRating",
                      "value": "4.0",
                      "disabled": true
                    },
                    {
                      "key": "page",
                      "value": "1"
                    },
                    {
                      "key": "limit",
                      "value": "10"
                    },
                    {
                      "key": "sortBy",
                      "value": "rating"
                    },
                    {
                      "key": "sortOrder",
                      "value": "desc"
                    }
                  ]
                },
                "description": "**GET /stalls - Listing Warung dengan Pagination**\n\n**Query Parameters:**\n- `search` (optional): Keyword pencarian berdasarkan nama warung\n- `category` (optional): Filter berdasarkan kategori (Indonesian Food, Fast Food, Beverages, dll)\n- `minRating` (optional): Filter minimal rating (0-5)\n- `page` (default: 1): Halaman ke berapa\n- `limit` (default: 10): Jumlah item per halaman\n- `sortBy` (default: rating): Field untuk sorting (rating, name, createdAt)\n- `sortOrder` (default: desc): Urutan sorting (asc/desc)\n\n**Response Structure:**\n```json\n{\n  \"data\": [\n    {\n      \"id\": \"string\",\n      \"name\": \"string\",\n      \"description\": \"string\",\n      \"imageUrl\": \"string\",\n      \"category\": \"string\",\n      \"rating\": number,\n      \"totalReviews\": number\n    }\n  ],\n  \"meta\": {\n    \"total\": number,\n    \"page\": number,\n    \"limit\": number,\n    \"totalPages\": number\n  }\n}\n```\n\n**Note:** Response TIDAK include `ownerId`, `createdAt`, `updatedAt` untuk privacy dan simplicity."
              },
              "response": []
            },
            {
              "name": "Get Stall Detail",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{user_token}}",
                    "type": "text"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/stalls/{{stall_id}}",
                  "host": ["{{base_url}}"],
                  "path": ["stalls", "{{stall_id}}"]
                },
                "description": "**GET /stalls/:id - Detail Warung**\n\n**Parameter:**\n- `:id` (path param): ID warung yang ingin dilihat\n\n**Response Structure:**\n```json\n{\n  \"data\": {\n    \"id\": \"string\",\n    \"name\": \"string\",\n    \"description\": \"string\",\n    \"category\": \"string\",\n    \"rating\": number,\n    \"totalReviews\": number,\n    \"menuItems\": [\n      {\n        \"id\": \"string\",\n        \"name\": \"string\",\n        \"description\": \"string\",\n        \"price\": number,\n        \"imageUrl\": \"string\",\n        \"isAvailable\": boolean\n      }\n    ]\n  }\n}\n```\n\n**Note:**\n- Response TIDAK include `ownerId`, `imageUrl` (stall image), `createdAt`, `updatedAt`\n- `menuItems` adalah array (bisa kosong [] jika belum ada menu)\n- Field `menuItems` akan diisi saat fitur menu management sudah diimplementasi"
              },
              "response": []
            },
            {
              "name": "Search Stalls",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{user_token}}",
                    "type": "text"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/stalls?search={{search_keyword}}",
                  "host": ["{{base_url}}"],
                  "path": ["stalls"],
                  "query": [
                    {
                      "key": "search",
                      "value": "{{search_keyword}}"
                    }
                  ]
                },
                "description": "**GET /stalls?search=keyword - Search Warung**\n\n**Query Parameter:**\n- `search`: Keyword pencarian (case-insensitive, search di nama warung)\n\n**Contoh:**\n- `?search=siti` → cari warung dengan nama mengandung \"siti\"\n- `?search=nasi` → cari warung dengan nama mengandung \"nasi\"\n\n**Note:**\n- Search dilakukan client-side (Firestore limitation)\n- Bisa kombinasikan dengan filter lain (category, minRating, dll)\n- Response structure sama dengan GET /stalls (listing)"
              },
              "response": []
            }
          ]
        }
      ]
    },
    {
      "name": "Admin Endpoints",
      "description": "Endpoints untuk Admin Sistem (Tim Pengembang)",
      "item": [
        {
          "name": "Auth",
          "item": [
            {
              "name": "Register Admin",
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"username\": \"{{admin_username}}\",\n  \"email\": \"{{admin_email}}\",\n  \"password\": \"{{admin_password}}\",\n  \"confirmPassword\": \"{{admin_password}}\"\n}"
                },
                "url": {
                  "raw": "{{base_url}}/auth/register-admin",
                  "host": ["{{base_url}}"],
                  "path": ["auth", "register-admin"]
                },
                "description": "Register admin sistem (tim dev). **INTERNAL USE ONLY!**"
              },
              "response": []
            },
            {
              "name": "Login Admin",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "var jsonData = pm.response.json();",
                      "if (jsonData.success && jsonData.data && jsonData.data.token) {",
                      "    pm.environment.set(\"admin_token\", jsonData.data.token);",
                      "    console.log(\"Admin token saved\");",
                      "}"
                    ],
                    "type": "text/javascript"
                  }
                }
              ],
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"identifier\": \"{{admin_email}}\",\n  \"password\": \"{{admin_password}}\"\n}"
                },
                "url": {
                  "raw": "{{base_url}}/auth/login",
                  "host": ["{{base_url}}"],
                  "path": ["auth", "login"]
                },
                "description": "Login sebagai admin. Token auto-saved ke `{{admin_token}}`"
              },
              "response": []
            },
            {
              "name": "Logout Admin",
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{admin_token}}",
                    "type": "text"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/auth/logout",
                  "host": ["{{base_url}}"],
                  "path": ["auth", "logout"]
                },
                "description": "Logout sebagai admin dan revoke semua refresh tokens."
              },
              "response": []
            }
          ]
        },
        {
          "name": "Stall Owner Management",
          "item": [
            {
              "name": "Register Stall Owner + Create Stall",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "var jsonData = pm.response.json();",
                      "if (jsonData.success && jsonData.data) {",
                      "    if (jsonData.data.stall && jsonData.data.stall.id) {",
                      "        pm.environment.set(\"stall_id\", jsonData.data.stall.id);",
                      "        console.log(\"Stall ID saved: \" + jsonData.data.stall.id);",
                      "    }",
                      "    if (jsonData.data.user) {",
                      "        console.log(\"Stall owner created:\");",
                      "        console.log(\"Username: \" + jsonData.data.user.username);",
                      "        console.log(\"Email: \" + jsonData.data.user.email);",
                      "    }",
                      "}"
                    ],
                    "type": "text/javascript"
                  }
                }
              ],
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{admin_token}}",
                    "type": "text"
                  }
                ],
                "body": {
                  "mode": "formdata",
                  "formdata": [
                    {
                      "key": "username",
                      "value": "{{owner_username}}",
                      "type": "text",
                      "description": "Username pemilik warung"
                    },
                    {
                      "key": "email",
                      "value": "{{owner_email}}",
                      "type": "text",
                      "description": "Email pemilik warung"
                    },
                    {
                      "key": "password",
                      "value": "{{owner_password}}",
                      "type": "text",
                      "description": "Password pemilik warung"
                    },
                    {
                      "key": "confirmPassword",
                      "value": "{{owner_password}}",
                      "type": "text",
                      "description": "Konfirmasi password"
                    },
                    {
                      "key": "stallName",
                      "value": "{{stall_name}}",
                      "type": "text",
                      "description": "Nama warung"
                    },
                    {
                      "key": "stallDescription",
                      "value": "{{stall_description}}",
                      "type": "text",
                      "description": "Deskripsi warung"
                    },
                    {
                      "key": "stallCategory",
                      "value": "{{stall_category}}",
                      "type": "text",
                      "description": "Kategori warung"
                    },
                    {
                      "key": "stallImage",
                      "type": "file",
                      "src": [],
                      "description": "Gambar warung (JPG, PNG, WebP, max 5MB)"
                    }
                  ]
                },
                "url": {
                  "raw": "{{base_url}}/auth/register-stall-owner",
                  "host": ["{{base_url}}"],
                  "path": ["auth", "register-stall-owner"]
                },
                "description": "**Admin only**: Register pemilik warung + buat stall sekaligus.\n\nOutput:\n- User account (stall_owner role)\n- Stall data\n- Username & password untuk dikasih ke pemilik warung"
              },
              "response": []
            }
          ]
        }
      ]
    },
    {
      "name": "Stall Owner Endpoints",
      "description": "Endpoints untuk Pemilik Warung (Seamless - No ID!)",
      "item": [
        {
          "name": "Auth",
          "item": [
            {
              "name": "Login Stall Owner",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "var jsonData = pm.response.json();",
                      "if (jsonData.success && jsonData.data && jsonData.data.token) {",
                      "    pm.environment.set(\"owner_token\", jsonData.data.token);",
                      "    console.log(\"Owner token saved\");",
                      "}"
                    ],
                    "type": "text/javascript"
                  }
                }
              ],
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"identifier\": \"{{owner_email}}\",\n  \"password\": \"{{owner_password}}\"\n}"
                },
                "url": {
                  "raw": "{{base_url}}/auth/login",
                  "host": ["{{base_url}}"],
                  "path": ["auth", "login"]
                },
                "description": "Login sebagai pemilik warung. Token auto-saved ke `{{owner_token}}`"
              },
              "response": []
            },
            {
              "name": "Logout Stall Owner",
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{owner_token}}",
                    "type": "text"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/auth/logout",
                  "host": ["{{base_url}}"],
                  "path": ["auth", "logout"]
                }
              },
              "response": []
            }
          ]
        },
        {
          "name": "My Stall (Seamless)",
          "item": [
            {
              "name": "Get My Stall",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{owner_token}}",
                    "type": "text"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/stalls/my-stall",
                  "host": ["{{base_url}}"],
                  "path": ["stalls", "my-stall"]
                },
                "description": "**Seamless!** Get warung milik sendiri tanpa perlu ID."
              },
              "response": []
            },
            {
              "name": "Update My Stall",
              "request": {
                "method": "PATCH",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{owner_token}}",
                    "type": "text"
                  }
                ],
                "body": {
                  "mode": "formdata",
                  "formdata": [
                    {
                      "key": "name",
                      "value": "Warung Bu Siti (Updated)",
                      "type": "text",
                      "disabled": true
                    },
                    {
                      "key": "description",
                      "value": "Deskripsi baru untuk warung saya",
                      "type": "text",
                      "disabled": true
                    },
                    {
                      "key": "category",
                      "value": "Fast Food",
                      "type": "text",
                      "disabled": true
                    },
                    {
                      "key": "image",
                      "type": "file",
                      "src": [],
                      "description": "Gambar baru (optional)",
                      "disabled": true
                    }
                  ]
                },
                "url": {
                  "raw": "{{base_url}}/stalls/my-stall",
                  "host": ["{{base_url}}"],
                  "path": ["stalls", "my-stall"]
                },
                "description": "**Seamless!** Update warung tanpa ID. Semua field optional."
              },
              "response": []
            },
            {
              "name": "Delete My Stall",
              "request": {
                "method": "DELETE",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{owner_token}}",
                    "type": "text"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/stalls/my-stall",
                  "host": ["{{base_url}}"],
                  "path": ["stalls", "my-stall"]
                },
                "description": "**Seamless!** Delete warung tanpa ID.\n\n**WARNING:** Data & gambar dihapus permanen!"
              },
              "response": []
            }
          ]
        },
        {
          "name": "Menu Management",
          "item": [
            {
              "name": "Create Menu Item",
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{owner_token}}",
                    "type": "text"
                  }
                ],
                "body": {
                  "mode": "formdata",
                  "formdata": [
                    {
                      "key": "name",
                      "value": "Nasi Goreng Special",
                      "type": "text"
                    },
                    {
                      "key": "description",
                      "value": "Nasi goreng dengan telur, ayam, dan sayuran segar",
                      "type": "text"
                    },
                    {
                      "key": "price",
                      "value": "15000",
                      "type": "text"
                    },
                    {
                      "key": "isAvailable",
                      "value": "true",
                      "type": "text",
                      "disabled": true
                    },
                    {
                      "key": "image",
                      "type": "file",
                      "src": []
                    }
                  ]
                },
                "url": {
                  "raw": "{{base_url}}/stalls/my-stall/menu-items",
                  "host": ["{{base_url}}"],
                  "path": ["stalls", "my-stall", "menu-items"]
                },
                "description": "**POST /stalls/my-stall/menu-items - Create Menu Item**\\n\\n**Required:**\\n- `name`: Nama menu (3-100 karakter)\\n- `description`: Deskripsi menu (10-500 karakter)\\n- `price`: Harga (100-1.000.000, integer)\\n- `image`: File gambar menu (JPG/PNG/WebP, max 5MB)\\n\\n**Optional:**\\n- `isAvailable`: Status ketersediaan (default: true)\\n\\n**Response:**\\nMenu item yang baru dibuat dengan imageUrl dari Firebase Storage"
              },
              "response": []
            },
            {
              "name": "Get My Menu Items",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{owner_token}}",
                    "type": "text"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/stalls/my-stall/menu-items",
                  "host": ["{{base_url}}"],
                  "path": ["stalls", "my-stall", "menu-items"]
                },
                "description": "**GET /stalls/my-stall/menu-items - List Menu Items**\\n\\nGet semua menu items dari warung sendiri.\\n\\n**Response:**\\nArray of menu items, sorted by createdAt descending"
              },
              "response": []
            },
            {
              "name": "Get Single Menu Item",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{owner_token}}",
                    "type": "text"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/stalls/my-stall/menu-items/{{menu_item_id}}",
                  "host": ["{{base_url}}"],
                  "path": ["stalls", "my-stall", "menu-items", "{{menu_item_id}}"]
                },
                "description": "**GET /stalls/my-stall/menu-items/:id - Get Single Menu Item**\\n\\nGet detail menu item by ID.\\n\\n**Note:** Akan verify ownership otomatis"
              },
              "response": []
            },
            {
              "name": "Update Menu Item",
              "request": {
                "method": "PATCH",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{owner_token}}",
                    "type": "text"
                  }
                ],
                "body": {
                  "mode": "formdata",
                  "formdata": [
                    {
                      "key": "name",
                      "value": "Nasi Goreng Special (Updated)",
                      "type": "text",
                      "disabled": true
                    },
                    {
                      "key": "description",
                      "value": "Deskripsi yang diupdate",
                      "type": "text",
                      "disabled": true
                    },
                    {
                      "key": "price",
                      "value": "18000",
                      "type": "text",
                      "disabled": true
                    },
                    {
                      "key": "isAvailable",
                      "value": "false",
                      "type": "text",
                      "disabled": true
                    },
                    {
                      "key": "image",
                      "type": "file",
                      "src": [],
                      "disabled": true
                    }
                  ]
                },
                "url": {
                  "raw": "{{base_url}}/stalls/my-stall/menu-items/{{menu_item_id}}",
                  "host": ["{{base_url}}"],
                  "path": ["stalls", "my-stall", "menu-items", "{{menu_item_id}}"]
                },
                "description": "**PATCH /stalls/my-stall/menu-items/:id - Update Menu Item**\\n\\n**All fields optional:**\\n- `name`: Nama menu baru\\n- `description`: Deskripsi baru\\n- `price`: Harga baru\\n- `isAvailable`: Status ketersediaan\\n- `image`: Gambar baru (akan hapus gambar lama)\\n\\n**Note:** Jika upload image baru, gambar lama akan dihapus otomatis"
              },
              "response": []
            },
            {
              "name": "Delete Menu Item",
              "request": {
                "method": "DELETE",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{owner_token}}",
                    "type": "text"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/stalls/my-stall/menu-items/{{menu_item_id}}",
                  "host": ["{{base_url}}"],
                  "path": ["stalls", "my-stall", "menu-items", "{{menu_item_id}}"]
                },
                "description": "**DELETE /stalls/my-stall/menu-items/:id - Delete Menu Item**\\n\\nHapus menu item dari warung sendiri.\\n\\n**WARNING:**\\n- Data menu dihapus permanen\\n- Gambar juga dihapus dari Storage\\n- Tidak bisa di-restore!"
              },
              "response": []
            }
          ]
        }
      ]
    }
  ]
}
